<aetgt:getResponse xmlns:aetgt="http://schemas.active-endpoints.com/appmodules/repository/2010/10/avrepository.xsd"
                   xmlns:types1="http://schemas.active-endpoints.com/appmodules/repository/2010/10/avrepository.xsd">
   <types1:Item>
      <types1:EntryId>Tv0CR3aaa-gt-3682685-2023-01-27T12:28:31.737Z::pd.xml</types1:EntryId>
      <types1:Name>ProcessAutoTag_POC_automation_-_Copy_1-1</types1:Name>
      <types1:MimeType>application/xml+process</types1:MimeType>
      <types1:Description/>
      <types1:AppliesTo/>
      <types1:Tags>.agent:VIP_IICS_SA_SG_ONPREM_GROUP</types1:Tags>
      <types1:VersionLabel>1.0</types1:VersionLabel>
      <types1:State>CURRENT</types1:State>
      <types1:ProcessGroup/>
      <types1:CreatedBy>mohsin.shah@vistra.com.SAML2</types1:CreatedBy>
      <types1:CreationDate>2023-01-27T12:28:32Z</types1:CreationDate>
      <types1:ModifiedBy/>
      <types1:PublicationStatus>unpublished</types1:PublicationStatus>
      <types1:AutosaveExists>false</types1:AutosaveExists>
      <types1:Entry>
         <process xmlns="http://schemas.active-endpoints.com/appmodules/screenflow/2010/10/avosScreenflow.xsd"
                  xmlns:tfm="http://schemas.active-endpoints.com/appmodules/screenflow/2021/04/taskflowModel.xsd"
                  xmlns:list="urn:activevos:spi:list:functions"
                  displayName="ProcessAutoTag_POC_automation - Copy 1"
                  name="ProcessAutoTag_POC_automation_-_Copy_1-1"
                  overrideAPIName="false">
            <parameterSet xmlns="http://schemas.active-endpoints.com/appmodules/screenflow/2021/04/taskflowModel.xsd"/>
            <appliesTo/>
            <description/>
            <tags>.agent:VIP_IICS_SA_SG_ONPREM_GROUP</tags>
            <generator>Informatica Process Designer 11</generator>
            <input>
               <parameter description="" name="fileEvent" type="reference">
                  <options>
                     <option name="required">false</option>
                     <option name="referenceTo">apc-VPC-automation-1:PlainFileContent</option>
                     <option name="isCopy">true</option>
                     <option name="guid">eBC8m97jrERi8iUMV97JcU</option>
                  </options>
               </parameter>
            </input>
            <output>
               <field description="" name="returnvalue" type="int">
                  <options>
                     <option name="required">false</option>
                     <option name="initialvalue">0</option>
                  </options>
               </field>
            </output>
            <tempFields>
               <field description="" name="tmp_metadata" type="string">
                  <options>
                     <option name="required">false</option>
                  </options>
               </field>
               <field description="" name="tmp_metadatalist" type="objectlist">
                  <options>
                     <option name="referenceTo">apc-VPC-automation-1:PlainFileContent</option>
                     <option hide="true" name="multiSelect">true</option>
                     <option name="required">false</option>
                     <option name="isCopy">true</option>
                     <option name="guid">eBC8m97jrERi8iUMV97JcU</option>
                  </options>
               </field>
               <field description="" name="tmp_vp_username" type="string">
                  <options>
                     <option name="required">false</option>
                  </options>
               </field>
               <field description="" name="tmp_vp_password" type="string">
                  <options>
                     <option name="required">false</option>
                  </options>
               </field>
               <field description="" name="tmp_vp_grant_type" type="string">
                  <options>
                     <option name="required">false</option>
                  </options>
               </field>
               <field description="" name="tmp_vp_base_url" type="string">
                  <options>
                     <option name="required">false</option>
                  </options>
               </field>
               <field description="" name="tmp_masterfile_number" type="string">
                  <options>
                     <option name="required">false</option>
                  </options>
               </field>
               <field description="" name="tmp_Discription" type="string">
                  <options>
                     <option name="required">false</option>
                  </options>
               </field>
               <field description="" name="tmp_Document_Date " type="string">
                  <options>
                     <option name="required">false</option>
                  </options>
               </field>
               <field description="" name="tmp_file" type="string">
                  <options>
                     <option name="required">false</option>
                  </options>
               </field>
               <field description="" name="tmp_file_name" type="string">
                  <options>
                     <option name="required">false</option>
                  </options>
               </field>
               <field description="" name="temp_email_input" type="reference">
                  <options>
                     <option name="referenceTo">AppConn-Email-2:EmailTaskInput</option>
                     <option name="required">false</option>
                     <option name="isCopy">true</option>
                     <option name="guid">aoe02ykQaGTbyAaF1TCOkh</option>
                  </options>
               </field>
               <field description="" name="temp_log_Table" type="reference">
                  <options>
                     <option name="referenceTo">ConnDBConfig-MailRoom-1:VIP_MR_Docstore_log</option>
                     <option name="required">false</option>
                     <option name="isCopy">true</option>
                     <option name="guid">6Hgd8hrwRY0iLq4Ifi93OM</option>
                  </options>
               </field>
               <field description="" name="tmp_Refcode_list" type="objectlist">
                  <options>
                     <option name="referenceTo">ConnectionDBDevVP-MR-1:RefMaster</option>
                     <option hide="true" name="multiSelect">true</option>
                     <option name="required">false</option>
                     <option name="guid">hsGCnr7xIEAhJrBBvpBNwZ</option>
                  </options>
               </field>
            </tempFields>
            <notes/>
            <deployment skipIfRunning="false" suspendOnFault="false" tracingLevel="verbose">
               <targetLocation>VIP_IICS_SA_SG_ONPREM_GROUP</targetLocation>
               <event eventSource="apc-VPC-automation-1:FileParser"/>
            </deployment>
            <flow id="a">
               <start id="b">
                  <link id="l9cleq4f" targetId="l9cleq4e"/>
               </start>
               <assignment id="l9cleq4e">
                  <title>Assignment to tmp_metadatalist</title>
                  <operation source="formula" to="temp.tmp_metadatalist">
                     <expression language="XQuery">$input.fileEvent[1]/content
</expression>
                  </operation>
                  <link id="l9cleq4y" targetId="l9cleq4x"/>
               </assignment>
               <container id="l9cleq4x" type="exclusive">
                  <title>tmp_metadatalist</title>
                  <flow id="l9cleq51">
                     <assignment id="l9cleq5b">
                        <title>Assignment to tmp_metadata</title>
                        <operation source="formula" to="temp.tmp_metadata">
                           <expression language="XQuery">list:head($temp.tmp_metadatalist )</expression>
                        </operation>
                        <link id="l9cleq5x" targetId="l9cleq5w"/>
                     </assignment>
                     <assignment id="l9cleq5w">
                        <title>Assignment to tmp_masterfile_number, tmp_Discription etc.</title>
                        <operation source="formula" to="temp.tmp_masterfile_number">
                           <expression language="XQuery">fn:substring-before($temp.tmp_metadata , '|')</expression>
                        </operation>
                        <operation source="formula" to="temp.tmp_Discription">
                           <expression language="XQuery">fn:substring-before(fn:substring-after(
fn:substring-after($temp.tmp_metadata,'|'),'|'),'|')
</expression>
                        </operation>
                        <operation source="formula" to="temp.tmp_Document_Date ">
                           <expression language="XQuery">fn:substring-before(fn:substring-after(fn:substring-after(
fn:substring-after($temp.tmp_metadata,'|'),'|'),'|'),'|')</expression>
                        </operation>
                        <operation source="formula" to="temp.tmp_file">
                           <expression language="XQuery">fn:substring-after(fn:substring-after(fn:substring-after(fn:substring-after(
fn:substring-after($temp.tmp_metadata,'|'),'|'),'|'),'|'),'|')</expression>
                        </operation>
                        <link id="l9cleq8m" targetId="l9cleq8q"/>
                     </assignment>
                     <assignment id="l9cleq7k">
                        <title>Assignment to tmp_metadatalist</title>
                        <operation source="formula" to="temp.tmp_metadatalist">
                           <expression language="XQuery">list:tail($temp.tmp_metadatalist )</expression>
                        </operation>
                        <link id="l9cleq83" targetId="l9cleq81"/>
                     </assignment>
                     <eventContainer id="l9cleq8q">
                        <service id="l9cleq8l">
                           <title>Prc_gettoken</title>
                           <serviceName>Prc_gettoken-1</serviceName>
                           <serviceGUID>7EpObMYFK07gNOPn4hzW63</serviceGUID>
                           <serviceInput/>
                        </service>
                        <flow id="l9cleq8s">
                           <assignment id="l9coyko9">
                              <title>Assignment to tmp_vp_base_url, tmp_Refcode_list</title>
                              <operation source="constant" to="temp.tmp_vp_base_url">https://web.clmvpcdev.vaws/rest/</operation>
                              <operation source="list" to="temp.tmp_Refcode_list">
                                 <query advanceQuery="false" from="ConnectionDBDevVP-MR:RefMaster">
                                    <where>RefCode ='{$temp.tmp_masterfile_number}'</where>
                                 </query>
                              </operation>
                              <link id="l9coykoa" targetId="l9qohcjl"/>
                           </assignment>
                           <eventContainer id="l9qohcjl">
                              <service id="l9coyknr">
                                 <title>MoveFile</title>
                                 <serviceName>AppVPOINT:MoveFile</serviceName>
                                 <serviceGUID>2yoTG57R9i9l2hZnAQ03oj</serviceGUID>
                                 <serviceInput>
                                    <parameter name="access_token" source="field" updatable="true">output.o_Token</parameter>
                                    <parameter name="holderModel" source="formula">
                                       <expression language="XQuery">'{

"docNr": 0,

"folderNr":6,

"mfNumber": ','"',$temp.tmp_Refcode_list.MfNr ,'",

"docDate":','"',date:toDate($temp.tmp_Document_Date  , 'DD/MM/YYYY'),'",

"confRank": 0,

"vpCode": "",

"docStatus": 0,

"docOrigin": 0,

"descr":','"',$temp.tmp_Discription ,'", 

"note": "Statement",

"dateIndex":','"',fn:current-dateTime(),'", 

"ucodeIndex": "SM",

"dateUpdate":','"',fn:current-dateTime(),'", 

"ucodeUpdate": "SM",

"procStatus": 1,

"storeStatus": null,

"numFiles": 0,

"relations": [

{

"relDocNr": 855,

"relNr": 1,

"ixField": 1,

"fldKey": "INDEX",

"fldType": 40,

"fldCap": "Master File",

"valNumber":','"',$temp.tmp_masterfile_number ,'",

"valText": null,

"valShow":','"',$temp.tmp_masterfile_number ,'", 

},

{

"relDocNr": 855,

"relNr": 2,

"ixField": 2,

"fldKey": "DOCDATE",

"fldType": 33,

"fldCap": "Document Date",

"valNumber": 43690.0,

"valText": null,

"valShow": ','"',date:toDate($temp.tmp_Document_Date  , 'DD/MM/YYYY'),'",

},
{

"relDocNr": 855,

"relNr": 3,

"ixField": 43,

"fldKey": "DOCTYPE",

"fldType": 71,

"fldCap": "Banking Document Type",

"valNumber": 0,

"valText": "STA",

"valShow": "Statement"

}

],

"tasks": [],

"Files": [],

}'</expression>
                                    </parameter>
                                    <parameter name="file" source="formula">
                                       <expression language="XQuery">sff:createAttachmentFromBase64( '$temp.tmp_masterfile_number ' ,$temp.tmp_file   ,'application/pdf' )</expression>
                                    </parameter>
                                    <parameter name="base_url" source="field" updatable="true">temp.tmp_vp_base_url</parameter>
                                 </serviceInput>
                              </service>
                              <flow id="l9qohcjn">
                                 <link id="l9qohcjo" targetId="l9qohcjl" type="containerLink"/>
                              </flow>
                              <flow id="l9qohcjq">
                                 <create id="l9qohck0">
                                    <title>VIP_MR_Docstore_log</title>
                                    <entityName>ConnDBConfig-3:VIP_MR_Docstore_log</entityName>
                                    <createInput>
                                       <parameter name="Bank_Statement_File_Name" source="constant" updatable="true">fn:concat($temp.tmp_masterfile_number, '.pdf')</parameter>
                                       <parameter name="Document_Store_Status" source="constant" updatable="true">Failed</parameter>
                                       <parameter name="Document_Store_Date" source="formula" updatable="true">
                                          <expression language="XQuery">date:toDate($temp.tmp_Document_Date, 'DD/MM/YYYY')</expression>
                                       </parameter>
                                       <parameter name="Document_Store_Comments" source="formula" updatable="true">
                                          <expression language="XQuery">fn:concat($output.ResponseStatusCode , $output.out_holderNr )</expression>
                                       </parameter>
                                    </createInput>
                                    <link id="l9qohcm6" targetId="l9qohcm4"/>
                                 </create>
                                 <jumpTo id="l9qohcm4">
                                    <link id="l9qohcm5" targetId="l9cleq7k"/>
                                 </jumpTo>
                              </flow>
                              <link id="l9qohcjm" targetId="l9qohcjn" type="containerLink"/>
                              <link id="l9qo2xvj" targetId="l9qo2xvi"/>
                              <events>
                                 <catch faultField="faultInfo" id="l9qohcjk" interrupting="true">
                                    <link id="l9qohcjp" targetId="l9qohcjq" type="containerLink"/>
                                 </catch>
                              </events>
                           </eventContainer>
                           <create id="l9qo2xvi">
                              <title>VIP_MR_Docstore_log</title>
                              <entityName>ConnDBConfig-3:VIP_MR_Docstore_log</entityName>
                              <createInput>
                                 <parameter name="Bank_Statement_File_Name" source="formula" updatable="true">
                                    <expression language="XQuery">fn:concat($temp.tmp_masterfile_number, '.pdf')</expression>
                                 </parameter>
                                 <parameter name="Document_Store_Status" source="constant" updatable="true">Success</parameter>
                                 <parameter name="Document_Store_Date" source="formula" updatable="true">
                                    <expression language="XQuery">date:toDate($temp.tmp_Document_Date, 'DD/MM/YYYY')
</expression>
                                 </parameter>
                                 <parameter name="Document_Store_Comments" source="formula" updatable="true">
                                    <expression language="XQuery">fn:concat($output.ResponseStatusCode , $output.out_holderNr )</expression>
                                 </parameter>
                              </createInput>
                           </create>
                           <link id="l9cleq8t" targetId="l9cleq8q" type="containerLink"/>
                        </flow>
                        <flow id="l9cleq8v">
                           <end id="l9coykni">
                              <title>End 1</title>
                           </end>
                        </flow>
                        <link id="l9cleq8r" targetId="l9cleq8s" type="containerLink"/>
                        <link id="l9cleq8n" targetId="l9cleq7k"/>
                        <events>
                           <catch faultField="faultInfo" id="l9cleq8p" interrupting="true">
                              <link id="l9cleq8u" targetId="l9cleq8v" type="containerLink"/>
                           </catch>
                        </events>
                     </eventContainer>
                     <jumpTo id="l9cleq81">
                        <link id="l9cleq82" targetId="l9cleq4x"/>
                     </jumpTo>
                  </flow>
                  <flow id="l9cleq54">
                     <assignment id="l9qnctmg">
                        <title>Assignment to Recipient Addresses, Subject etc.</title>
                        <operation source="constant" to="temp.temp_email_input[1]/to">mohsin.shah@vistra.com</operation>
                        <operation source="constant" to="temp.temp_email_input[1]/subject">MDS status Report</operation>
                        <operation source="formula" to="temp.temp_email_input[1]/body">
                           <expression language="XQuery">fn:concat('Hi OSC Team,','&amp;#10;','&amp;#10;', 'Files have been moved to View Point', '&amp;#10;' ,'&amp;#10;','&amp;#10;','Thanks','&amp;#10;', 'VIP Team','&amp;#10;','&amp;#10;')
</expression>
                        </operation>
                        <link id="l9qnctn3" targetId="l9qnctn2"/>
                     </assignment>
                     <service id="l9qnctn2">
                        <title>sendEmailService</title>
                        <serviceName>AppConn-Email-2:sendEmailService</serviceName>
                        <serviceGUID>aoe02ykQaGTbyAaF1TCOkh</serviceGUID>
                        <serviceInput>
                           <parameter name="emailTaskInput" source="field" updatable="true">temp.temp_email_input</parameter>
                        </serviceInput>
                        <link id="l9qnctn4" targetId="l9cleq5j"/>
                     </service>
                     <end id="l9cleq5j">
                        <title>End 2</title>
                     </end>
                  </flow>
                  <link id="l9cleq50" targetId="l9cleq51" type="containerLink">
                     <condition source="formula">
                        <function name="not-empty">
                           <arg name="field">{$temp.tmp_metadatalist}</arg>
                        </function>
                     </condition>
                  </link>
                  <link id="l9cleq53" targetId="l9cleq54" type="containerLink">
                     <condition source="formula">
                        <function name="empty">
                           <arg name="field">{$temp.tmp_metadatalist}</arg>
                        </function>
                     </condition>
                  </link>
               </container>
            </flow>
         </process>
         <ns1:sample-data-sets xmlns:ns1="http://schemas.active-endpoints.com/appmodules/repository/2010/10/sampleData.xsd">
            <ns1:SampleData>
               <ns1:Id>2f282044-f14f-4caf-8141-19a1de33f8d1</ns1:Id>
               <ns1:Name>test1</ns1:Name>
               <ns1:CreatedBy>mohsin.shah@vistra.com.SAML2</ns1:CreatedBy>
               <ns1:CreationDate>2023-01-27T12:28:32Z</ns1:CreationDate>
               <ns1:ModifiedBy>mohsin.shah@vistra.com.SAML2</ns1:ModifiedBy>
               <ns1:ModificationDate>2023-01-27T12:28:32Z</ns1:ModificationDate>
               <ns1:Data format="json">{}</ns1:Data>
            </ns1:SampleData>
         </ns1:sample-data-sets>
      </types1:Entry>
      <types1:GUID>gh00TF4iMSrhWCpsE9iEMi</types1:GUID>
      <types1:DisplayName>ProcessAutoTag_POC_automation - Copy 1</types1:DisplayName>
   </types1:Item>
   <types1:CurrentServerDateTime>2023-02-04T16:14:48.012Z</types1:CurrentServerDateTime>
</aetgt:getResponse>
